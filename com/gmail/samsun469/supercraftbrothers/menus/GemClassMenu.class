package com.gmail.samsun469.supercraftbrothers.menus;

import com.gmail.samsun469.supercraftbrothers.SCBPlayer;
import com.gmail.samsun469.supercraftbrothers.SCBRank;
import com.gmail.samsun469.supercraftbrothers.SuperCraftBrothers;
import com.gmail.samsun469.supercraftbrothers.managers.PlayerManager;
import com.gmail.samsun469.supercraftbrothers.managers.RankManager;
import com.gmail.samsun469.supercraftbrothers.managers.StatsManager;
import java.util.List;
import org.bukkit.ChatColor;
import org.bukkit.Material;
import org.bukkit.entity.Player;
import org.bukkit.inventory.ItemStack;

public class GemClassMenu
{
  private GemClassMenuIM gemclass;
  private Player p;
  private SCBPlayer bro;
  
  public GemClassMenu(SuperCraftBrothers scb, Player p)
  {
    this.p = p;
    this.gemclass = new GemClassMenuIM("§2Gem Characters", 27, scb);
  }
  
  public String[] descs = new String[7];
  public static int[] prices = { 100, 50, 100, 100, 100, 200, 50 };
  public static String[] classes = { "ButterBro", "Chicken", "Notch", "Ocelot", "Witch", "WitherSkeleton", "Tnt" };
  public static ItemStack[] items = {
    new ItemStack(Material.GOLD_INGOT, 1), 
    new ItemStack(Material.EGG, 1), 
    new ItemStack(Material.GRASS, 1), 
    new ItemStack(Material.MONSTER_EGG, 1, 98), 
    new ItemStack(Material.POTION, 1), 
    new ItemStack(Material.LEATHER_CHESTPLATE, 1), 
    new ItemStack(Material.TNT, 1) };
  
  public void openMenu()
  {
    this.bro = PlayerManager.getCraftBrother(this.p);
    setupShop(this.p);
    for (int i = 0; i < classes.length; i++) {
      this.gemclass.setOption(i, items[i], classes[i], new String[] { this.descs[i] });
    }
    this.gemclass.open(this.p);
  }
  
  public void setupShop(Player p)
  {
    for (int i = 0; i < classes.length; i++) {
      if (RankManager.getPlayerRank(p.getName()).getClasses().contains(classes[i])) {
        this.descs[i] = "§aPurchased!";
      } else if (StatsManager.getPlayerClass(p.getName(), classes[i])) {
        this.descs[i] = "§aPurchased!";
      } else {
        this.descs[i] = "§cYou have not yet purchased this class";
      }
    }
  }
  
  public void onOptionClick(String c)
  {
    if ((this.p.hasPermission("scb.class." + c.toLowerCase())) || (RankManager.getPlayerRank(this.p.getName()).getClasses().contains(c))) {
      this.bro.setCurrentClass(c);
    } else if (StatsManager.getPlayerClass(this.bro.getPlayer().getName(), c)) {
      this.bro.setCurrentClass(c);
    } else {
      this.bro.getPlayer().sendMessage(ChatColor.RED + "You do not own this class, buy it in the Gem Class Shop");
    }
    GemClassMenuIM.removeFromList(this.p);
  }
}
